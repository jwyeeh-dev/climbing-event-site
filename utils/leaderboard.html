<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì‹¤ì‹œê°„ ë¦¬ë”ë³´ë“œ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>

  <!-- ì• ë‹ˆë©”ì´ì…˜ ì •ì˜ -->
  <style>
    @keyframes slideUp {
      0%   { transform: translateY(20px); opacity: 0; }
      100% { transform: translateY(0);    opacity: 1; }
    }
    @keyframes slideDown {
      0%   { transform: translateY(-20px); opacity: 0; }
      100% { transform: translateY(0);     opacity: 1; }
    }
    .rank-up   { animation: slideUp   0.8s ease-out; }
    .rank-down { animation: slideDown 0.8s ease-out; }

    /* ë©”ë‹¬ ë°°ê²½ */
    .rank-1 { background:#FFD700;color:#000; }
    .rank-2 { background:#C0C0C0;color:#000; }
    .rank-3 { background:#CD7F32;color:#fff; }
  </style>
</head>
<body class="bg-gray-100">

  <div x-data="board()" x-init="init()" class="max-w-4xl mx-auto p-8">
    <h1 class="text-4xl font-extrabold text-center mb-2 text-gray-800">ğŸ† ì‹¤ì‹œê°„ ë¦¬ë”ë³´ë“œ</h1>
    <p class="text-center text-gray-500 mb-10">5ì´ˆë§ˆë‹¤ ìë™ ì—…ë°ì´íŠ¸</p>

    <div class="bg-white shadow-2xl rounded-2xl overflow-hidden">
      <div class="divide-y divide-gray-200">
        <!-- ìˆœìœ„ë³„ í–‰ -->
        <template x-for="team in ranking" :key="team.id">
          <div
            class="flex items-center p-5 transition-all duration-500"
            :class="[
              team.rankClass,
              team.movement === 'up'   ? 'rank-up'   :
              team.movement === 'down' ? 'rank-down' : '' ]"
          >
            <div class="w-16 h-16 flex items-center justify-center text-2xl font-bold rounded-full mr-6"
                 :class="team.medalClass">
              <span x-text="team.rank"></span>
            </div>
            <div class="flex-1">
              <p class="text-xl font-semibold text-gray-800" x-text="team.name + 'ì¡°'"></p>
            </div>
            <div class="text-3xl font-bold text-orange-600">
              <span x-text="team.total"></span>
              <span class="text-lg text-gray-500">ì </span>
            </div>
          </div>
        </template>
      </div>
    </div>

    <p class="mt-6 text-center text-xs text-gray-500">
      ì ìˆ˜ê°€ ë³€ê²½ëœ ë’¤ ìƒˆë¡œê³ ì¹¨ ì—†ì´ë„ 5ì´ˆ ë‚´ë¡œ ì• ë‹ˆë©”ì´ì…˜ê³¼ í•¨ê»˜ ìˆœìœ„ê°€ ê°±ì‹ ë©ë‹ˆë‹¤.
    </p>
  </div>

  <script>
    function board () {
      return {
        teams: [],           // ì›ì‹œ ë°ì´í„°
        ranking: [],         // ì •ë ¬Â·ê°€ê³µ í›„ ë³´ì—¬ì¤„ ë°°ì—´
        prevRanks: {},       // team.id âœ ì§ì „ ë­í¬

        /* localStorage ì—ì„œ ì½ì–´ì˜¤ê¸° */
        load () {
          const raw = localStorage.getItem('leaderboardData');
          if (!raw) return;
          try { this.teams = JSON.parse(raw); }
          catch (e) { console.error('íŒŒì‹± ì˜¤ë¥˜', e); }
        },

        /* ë­í‚¹Â·ì• ë‹ˆë©”ì´ì…˜ ê³„ì‚° */
        updateRanking () {
          // ì ìˆ˜ ë‚´ë¦¼ì°¨ìˆœ â†’ ë­í¬ ë¶€ì—¬
          const sorted = [...this.teams].sort((a, b) => b.total - a.total);
          let rank = 1;
          sorted.forEach((t, i) => {
            if (i > 0 && t.total < sorted[i-1].total) rank = i + 1;
            const prev = this.prevRanks[t.id] || rank;
            t.rank      = rank;
            t.movement  = rank < prev ? 'up' : rank > prev ? 'down' : 'same';
            t.medalClass = rank <= 3 ? `rank-${rank}` : 'bg-gray-200';
            this.prevRanks[t.id] = rank;
          });
          this.ranking = sorted;
        },

        /* ì´ˆê¸°í™” */
        init () {
          this.load();
          this.updateRanking();
          // 5ì´ˆë§ˆë‹¤ ìƒˆë¡œ ë¶ˆëŸ¬ì™€ ê°±ì‹ 
          setInterval(() => {
            this.load();
            this.updateRanking();
          }, 5000);
        }
      };
    }
  </script>
</body>
</html>
